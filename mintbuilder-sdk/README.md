# EVM MintBuilder
A customized NFT minter with a frontend, backend, and on-chain smart contracts for minting user-configured ERC721 NFTs on demand.

## Architecture
The MintBuilder consists of 4 components:

1. **Smart Contracts** serve as the final point of truth, absolutely preventing duplicate mints or overminting of traits. 
2. **Commons** expose the smart contracts to JavaScript and are mainly generated by HardHat + TypeChain.
3. **Frontend** uses commons to post a "cryptographic commitment" to the *MintBuilder* contract on-chain along with the actual payment. You may choose whether this payment is in ETH/MATIC or in an ERC20. The contract reverts if the payment is not exact.
4. **Backend** verifies the user's commitment and mints the NFT.

### Backend Procedure
Once the user has posted their commitment on-chain, they reveal the commitment data to the backend. This is done to prevent all sorts of attack vectors on the somewhat asynchronous minting process.

The backend generally only fails minting the NFT under 3 conditions:
1. The backend's admin *Signer* does not have enough gas,
2. The chosen traits are already minted out, or
3. the exact trait combination has already been minted.

Once successfully minted, the backend produces the image & metadata and stores both on IPFS through [nft.storage](https://nft.storage), then points the NFT to the correct metadata IPFS URL. This can be done only once, preventing even you from reassigning the metadata.

### Backend Recovery
Should the backend somehow crash during a mint event it can restore its state from the smart contract & IPFS. When a new collection is created, its configuration is stored on IPFS and its CID stored in the contract. The remaining limits are stored directly in the smart contract. Thus, the backend is able to restore the mint event parameters automatically.
